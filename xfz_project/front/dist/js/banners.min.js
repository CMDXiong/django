function Banners(){}Banners.prototype.loadData=function(){var r=this;xfzajax.get({url:"/cms/banner_list/",success:function(n){if(200===n.code)for(var e=n.data,a=0;a<e.length;a++){var t=e[a];r.createBannerItem(t)}}})},Banners.prototype.createBannerItem=function(n){var e=this,a=template("banner-item",{banner:n}),t=$(".banner-list-group"),r=null;r=n?(t.append(a),t.find(".banner-item:last")):(t.prepend(a),t.find(".banner-item:first")),e.addImageSelectEvent(r),e.addRemoveBannerEvent(r),e.addSaveBannerEvent(r)},Banners.prototype.listenAddBannerEvent=function(){var n=this;$("#add-banner-btn").click(function(){n.createBannerItem()})},Banners.prototype.addImageSelectEvent=function(n){var a=n.find(".thumbnail"),e=n.find(".image-input");a.click(function(){e.click()}),e.change(function(){var n=this.files[0],e=new FormData;e.append("file",n),xfzajax.post({url:"/cms/upload_file/",data:e,processData:!1,contentType:!1,success:function(n){if(200===n.code){var e=n.data.url;a.attr("src",e)}}})})},Banners.prototype.addRemoveBannerEvent=function(e){var n=e.find(".close-btn"),a=e.attr("data-banner-id");n.click(function(){a?xfzalert.alertConfirm({text:"您确定要删除这个轮播图吗？",confirmCallback:function(){xfzajax.post({url:"/cms/delete_banner/",data:{banner_id:a},success:function(n){200===n.code&&(e.remove(),window.messageBox.showSuccess("轮播图删除成功"))}})}}):e.remove()})},Banners.prototype.addSaveBannerEvent=function(n){var e=n.find(".save-btn"),t=n.find(".thumbnail"),r=n.find("input[name='priority']"),i=n.find("input[name='link_to']"),o=n.find('span[class="priority"]');e.click(function(){var n=t.attr("src"),e=r.val(),a=i.val();xfzajax.post({url:"/cms/add_banner/",data:{image_url:n,priority:e,link_to:a},success:function(n){if(200===n.code){var e=n.data.banner_id;o.text("优先级："+e),window.messageBox.showSuccess("轮播图添加完成")}}})})},Banners.prototype.run=function(){this.listenAddBannerEvent(),this.loadData()},$(function(){(new Banners).run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhbm5lcnMuanMiXSwibmFtZXMiOlsiQmFubmVycyIsInByb3RvdHlwZSIsImxvYWREYXRhIiwic2VsZiIsInRoaXMiLCJ4ZnphamF4IiwiZ2V0IiwidXJsIiwic3VjY2VzcyIsInJlc3VsdCIsImJhbm5lcnMiLCJpIiwibGVuZ3RoIiwiYmFubmVyIiwiY3JlYXRlQmFubmVySXRlbSIsInRwbCIsInRlbXBsYXRlIiwiYmFubmVyTGlzdEdyb3VwIiwiJCIsImJhbm5lckl0ZW0iLCJhcHBlbmQiLCJmaW5kIiwicHJlcGVuZCIsImFkZEltYWdlU2VsZWN0RXZlbnQiLCJhZGRSZW1vdmVCYW5uZXJFdmVudCIsImFkZFNhdmVCYW5uZXJFdmVudCIsImxpc3RlbkFkZEJhbm5lckV2ZW50IiwiY2xpY2siLCJpbWFnZSIsImltYWdlSW5wdXQiLCJjaGFuZ2UiLCJmaWxlIiwiZmlsZXMiLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwicG9zdCIsImRhdGEiLCJwcm9jZXNzRGF0YSIsImNvbnRlbnRUeXBlIiwiYXR0ciIsImNsb3NlQnRuIiwiYmFubmVySWQiLCJ4ZnphbGVydCIsImFsZXJ0Q29uZmlybSIsInRleHQiLCJjb25maXJtQ2FsbGJhY2siLCJiYW5uZXJfaWQiLCJyZW1vdmUiLCJ3aW5kb3ciLCJtZXNzYWdlQm94Iiwic2hvd1N1Y2Nlc3MiLCJzYXZlQnRuIiwiaW1hZ2VUYWciLCJwcmlvcml0eVRhZyIsImxpbmt0b1RhZyIsInByaW9yaXR5U3BhbiIsImltYWdlX3VybCIsInByaW9yaXR5IiwidmFsIiwibGlua190byIsInJ1biJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsV0FHVEEsUUFBUUMsVUFBVUMsU0FBVyxXQUN6QixJQUFJQyxFQUFPQyxLQUNYQyxRQUFRQyxJQUFJLENBQ1JDLElBQU8sb0JBQ1BDLFFBQVcsU0FBVUMsR0FDakIsR0FBc0IsTUFBbkJBLEVBQWEsS0FFWixJQURBLElBQUlDLEVBQVVELEVBQWEsS0FDbkJFLEVBQUksRUFBR0EsRUFBRUQsRUFBUUUsT0FBUUQsSUFBSSxDQUNqQyxJQUFJRSxFQUFTSCxFQUFRQyxHQUNyQlIsRUFBS1csaUJBQWlCRCxRQVExQ2IsUUFBUUMsVUFBVWEsaUJBQW1CLFNBQVNELEdBQzFDLElBQUlWLEVBQVFDLEtBRVJXLEVBQU1DLFNBQVMsY0FBZSxDQUFDSCxPQUFTQSxJQUN4Q0ksRUFBa0JDLEVBQUUsc0JBQ3BCQyxFQUFhLEtBR2JBLEVBRkFOLEdBQ0FJLEVBQWdCRyxPQUFPTCxHQUNWRSxFQUFnQkksS0FBSyx1QkFFbENKLEVBQWdCSyxRQUFRUCxHQUNYRSxFQUFnQkksS0FBSyx1QkFFdENsQixFQUFLb0Isb0JBQW9CSixHQUN6QmhCLEVBQUtxQixxQkFBcUJMLEdBQzFCaEIsRUFBS3NCLG1CQUFtQk4sSUFHNUJuQixRQUFRQyxVQUFVeUIscUJBQXVCLFdBQ3JDLElBQUl2QixFQUFPQyxLQUNFYyxFQUFFLG1CQUNSUyxNQUFNLFdBQ1R4QixFQUFLVyxzQkFJYmQsUUFBUUMsVUFBVXNCLG9CQUFzQixTQUFTSixHQUM3QyxJQUFJUyxFQUFRVCxFQUFXRSxLQUFLLGNBRXhCUSxFQUFhVixFQUFXRSxLQUFLLGdCQUNqQ08sRUFBTUQsTUFBTSxXQUNSRSxFQUFXRixVQUdmRSxFQUFXQyxPQUFPLFdBQ2QsSUFBSUMsRUFBTzNCLEtBQUs0QixNQUFNLEdBQ2xCQyxFQUFXLElBQUlDLFNBQ25CRCxFQUFTYixPQUFPLE9BQVFXLEdBRXhCMUIsUUFBUThCLEtBQUssQ0FDVDVCLElBQU8sb0JBQ1A2QixLQUFRSCxFQUNSSSxhQUFlLEVBQ2ZDLGFBQWUsRUFDZjlCLFFBQVcsU0FBVUMsR0FDakIsR0FBdUIsTUFBbkJBLEVBQWEsS0FBVSxDQUN2QixJQUFJRixFQUFNRSxFQUFhLEtBQU8sSUFDOUJtQixFQUFNVyxLQUFLLE1BQU9oQyxVQVF0Q1AsUUFBUUMsVUFBVXVCLHFCQUF1QixTQUFTTCxHQUM5QyxJQUFJcUIsRUFBV3JCLEVBQVdFLEtBQUssY0FDM0JvQixFQUFXdEIsRUFBV29CLEtBQUssa0JBRS9CQyxFQUFTYixNQUFNLFdBQ1JjLEVBQ0NDLFNBQVNDLGFBQWEsQ0FDbEJDLEtBQVEsZ0JBQ1JDLGdCQUFtQixXQUNmeEMsUUFBUThCLEtBQUssQ0FDVDVCLElBQU0sc0JBQ042QixLQUFPLENBQ0hVLFVBQWFMLEdBRWpCakMsUUFBVyxTQUFVQyxHQUNLLE1BQW5CQSxFQUFhLE9BQ1pVLEVBQVc0QixTQUNYQyxPQUFPQyxXQUFXQyxZQUFZLGtCQVFsRC9CLEVBQVc0QixZQUt2Qi9DLFFBQVFDLFVBQVV3QixtQkFBcUIsU0FBU04sR0FDNUMsSUFBSWdDLEVBQVVoQyxFQUFXRSxLQUFLLGFBQzFCK0IsRUFBV2pDLEVBQVdFLEtBQUssY0FDM0JnQyxFQUFjbEMsRUFBV0UsS0FBSywwQkFDOUJpQyxFQUFZbkMsRUFBV0UsS0FBSyx5QkFDNUJrQyxFQUFlcEMsRUFBV0UsS0FBSywwQkFDbkM4QixFQUFReEIsTUFBTSxXQUNWLElBQUk2QixFQUFZSixFQUFTYixLQUFLLE9BQzFCa0IsRUFBV0osRUFBWUssTUFDdkJDLEVBQVVMLEVBQVVJLE1BQ3hCckQsUUFBUThCLEtBQUssQ0FDVjVCLElBQU8sbUJBQ042QixLQUFRLENBQ0pvQixVQUFhQSxFQUNiQyxTQUFZQSxFQUNaRSxRQUFXQSxHQUVmbkQsUUFBVyxTQUFVQyxHQUNqQixHQUFzQixNQUFuQkEsRUFBYSxLQUFVLENBQ3RCLElBQUlnQyxFQUFXaEMsRUFBYSxLQUFhLFVBQ3pDOEMsRUFBYVgsS0FBSyxPQUFPSCxHQUN6Qk8sT0FBT0MsV0FBV0MsWUFBWSxrQkFPbERsRCxRQUFRQyxVQUFVMkQsSUFBTSxXQUNUeEQsS0FDTnNCLHVCQURNdEIsS0FFTkYsWUFJVGdCLEVBQUUsWUFDZ0IsSUFBSWxCLFNBQ1Y0RCIsImZpbGUiOiJiYW5uZXJzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIEJhbm5lcnMoKSB7XG5cbn1cbkJhbm5lcnMucHJvdG90eXBlLmxvYWREYXRhID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgeGZ6YWpheC5nZXQoe1xuICAgICAgICAndXJsJzogJy9jbXMvYmFubmVyX2xpc3QvJyxcbiAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICBpZihyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKXtcbiAgICAgICAgICAgICAgICB2YXIgYmFubmVycyA9IHJlc3VsdFsnZGF0YSddO1xuICAgICAgICAgICAgICAgIGZvcih2YXIgaSA9IDA7IGk8YmFubmVycy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBiYW5uZXIgPSBiYW5uZXJzW2ldO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmNyZWF0ZUJhbm5lckl0ZW0oYmFubmVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgIH0pXG59O1xuXG5CYW5uZXJzLnByb3RvdHlwZS5jcmVhdGVCYW5uZXJJdGVtID0gZnVuY3Rpb24oYmFubmVyKXtcbiAgICB2YXIgc2VsZiAgPSB0aGlzO1xuXG4gICAgdmFyIHRwbCA9IHRlbXBsYXRlKFwiYmFubmVyLWl0ZW1cIiwge1wiYmFubmVyXCI6YmFubmVyfSk7XG4gICAgdmFyIGJhbm5lckxpc3RHcm91cCA9ICQoXCIuYmFubmVyLWxpc3QtZ3JvdXBcIik7XG4gICAgdmFyIGJhbm5lckl0ZW0gPSBudWxsO1xuICAgIGlmIChiYW5uZXIpe1xuICAgICAgICBiYW5uZXJMaXN0R3JvdXAuYXBwZW5kKHRwbCk7XG4gICAgICAgIGJhbm5lckl0ZW0gPSBiYW5uZXJMaXN0R3JvdXAuZmluZChcIi5iYW5uZXItaXRlbTpsYXN0XCIpO1xuICAgIH1lbHNle1xuICAgICAgICBiYW5uZXJMaXN0R3JvdXAucHJlcGVuZCh0cGwpO1xuICAgICAgICBiYW5uZXJJdGVtID0gYmFubmVyTGlzdEdyb3VwLmZpbmQoXCIuYmFubmVyLWl0ZW06Zmlyc3RcIik7XG4gICAgfVxuICAgIHNlbGYuYWRkSW1hZ2VTZWxlY3RFdmVudChiYW5uZXJJdGVtKTtcbiAgICBzZWxmLmFkZFJlbW92ZUJhbm5lckV2ZW50KGJhbm5lckl0ZW0pO1xuICAgIHNlbGYuYWRkU2F2ZUJhbm5lckV2ZW50KGJhbm5lckl0ZW0pO1xufTtcblxuQmFubmVycy5wcm90b3R5cGUubGlzdGVuQWRkQmFubmVyRXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBhZGRCdG4gPSAkKFwiI2FkZC1iYW5uZXItYnRuXCIpO1xuICAgIGFkZEJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIHNlbGYuY3JlYXRlQmFubmVySXRlbSgpO1xuICAgIH0pO1xufTtcblxuQmFubmVycy5wcm90b3R5cGUuYWRkSW1hZ2VTZWxlY3RFdmVudCA9IGZ1bmN0aW9uKGJhbm5lckl0ZW0pe1xuICAgIHZhciBpbWFnZSA9IGJhbm5lckl0ZW0uZmluZChcIi50aHVtYm5haWxcIik7XG4gICAgLy/lm77niYfkuI3og73miZPlvIDmlofku7bpgInmi6nmoYbnmoTvvIzlj6rog73pgJrov4dpbnB1dFt0eXBlPSdmaWxlJ11cbiAgICB2YXIgaW1hZ2VJbnB1dCA9IGJhbm5lckl0ZW0uZmluZChcIi5pbWFnZS1pbnB1dFwiKTtcbiAgICBpbWFnZS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgIGltYWdlSW5wdXQuY2xpY2soKTtcbiAgICB9KTtcblxuICAgIGltYWdlSW5wdXQuY2hhbmdlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGZpbGUgPSB0aGlzLmZpbGVzWzBdO1xuICAgICAgICB2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgZmlsZSk7XG5cbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcbiAgICAgICAgICAgICd1cmwnOiAnL2Ntcy91cGxvYWRfZmlsZS8nLFxuICAgICAgICAgICAgJ2RhdGEnOiBmb3JtRGF0YSxcbiAgICAgICAgICAgICdwcm9jZXNzRGF0YSc6IGZhbHNlLFxuICAgICAgICAgICAgJ2NvbnRlbnRUeXBlJzogZmFsc2UsXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT09IDIwMCl7XG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSByZXN1bHRbJ2RhdGEnXVsndXJsJ107XG4gICAgICAgICAgICAgICAgICAgIGltYWdlLmF0dHIoJ3NyYycsIHVybCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH0pO1xuXG59O1xuXG5CYW5uZXJzLnByb3RvdHlwZS5hZGRSZW1vdmVCYW5uZXJFdmVudCA9IGZ1bmN0aW9uKGJhbm5lckl0ZW0pe1xuICAgIHZhciBjbG9zZUJ0biA9IGJhbm5lckl0ZW0uZmluZChcIi5jbG9zZS1idG5cIik7XG4gICAgdmFyIGJhbm5lcklkID0gYmFubmVySXRlbS5hdHRyKCdkYXRhLWJhbm5lci1pZCcpO1xuXG4gICAgY2xvc2VCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBpZihiYW5uZXJJZCl7XG4gICAgICAgICAgICB4ZnphbGVydC5hbGVydENvbmZpcm0oe1xuICAgICAgICAgICAgICAgICd0ZXh0JzogJ+aCqOehruWumuimgeWIoOmZpOi/meS4qui9ruaSreWbvuWQl++8nycsXG4gICAgICAgICAgICAgICAgJ2NvbmZpcm1DYWxsYmFjayc6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgeGZ6YWpheC5wb3N0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICd1cmwnOicvY21zL2RlbGV0ZV9iYW5uZXIvJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhJzp7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Jhbm5lcl9pZCc6IGJhbm5lcklkXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzdWx0Wydjb2RlJ10gPT09IDIwMCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhbm5lckl0ZW0ucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dTdWNjZXNzKFwi6L2u5pKt5Zu+5Yig6Zmk5oiQ5YqfXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBiYW5uZXJJdGVtLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgfSk7XG59O1xuXG5CYW5uZXJzLnByb3RvdHlwZS5hZGRTYXZlQmFubmVyRXZlbnQgPSBmdW5jdGlvbihiYW5uZXJJdGVtKXtcbiAgICB2YXIgc2F2ZUJ0biA9IGJhbm5lckl0ZW0uZmluZChcIi5zYXZlLWJ0blwiKTtcbiAgICB2YXIgaW1hZ2VUYWcgPSBiYW5uZXJJdGVtLmZpbmQoJy50aHVtYm5haWwnKVxuICAgIHZhciBwcmlvcml0eVRhZyA9IGJhbm5lckl0ZW0uZmluZChcImlucHV0W25hbWU9J3ByaW9yaXR5J11cIik7XG4gICAgdmFyIGxpbmt0b1RhZyA9IGJhbm5lckl0ZW0uZmluZChcImlucHV0W25hbWU9J2xpbmtfdG8nXVwiKTtcbiAgICB2YXIgcHJpb3JpdHlTcGFuID0gYmFubmVySXRlbS5maW5kKCdzcGFuW2NsYXNzPVwicHJpb3JpdHlcIl0nKTtcbiAgICBzYXZlQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGltYWdlX3VybCA9IGltYWdlVGFnLmF0dHIoJ3NyYycpO1xuICAgICAgICB2YXIgcHJpb3JpdHkgPSBwcmlvcml0eVRhZy52YWwoKTtcbiAgICAgICAgdmFyIGxpbmtfdG8gPSBsaW5rdG9UYWcudmFsKCk7XG4gICAgICAgIHhmemFqYXgucG9zdCh7XG4gICAgICAgICAgICd1cmwnOiAnL2Ntcy9hZGRfYmFubmVyLycsXG4gICAgICAgICAgICAnZGF0YSc6IHtcbiAgICAgICAgICAgICAgICAnaW1hZ2VfdXJsJzogaW1hZ2VfdXJsLFxuICAgICAgICAgICAgICAgICdwcmlvcml0eSc6IHByaW9yaXR5LFxuICAgICAgICAgICAgICAgICdsaW5rX3RvJzogbGlua190b1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGlmKHJlc3VsdFsnY29kZSddID09PSAyMDApe1xuICAgICAgICAgICAgICAgICAgICB2YXIgYmFubmVySWQgPSByZXN1bHRbJ2RhdGEnXVsnYmFubmVyX2lkJ11cbiAgICAgICAgICAgICAgICAgICAgcHJpb3JpdHlTcGFuLnRleHQoXCLkvJjlhYjnuqfvvJpcIitiYW5uZXJJZCk7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3dTdWNjZXNzKFwi6L2u5pKt5Zu+5re75Yqg5a6M5oiQXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59O1xuXG5CYW5uZXJzLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYubGlzdGVuQWRkQmFubmVyRXZlbnQoKTtcbiAgICBzZWxmLmxvYWREYXRhKCk7XG5cbn07XG5cbiQoZnVuY3Rpb24gKCkge1xuICAgIHZhciBiYW5uZXJzID0gbmV3IEJhbm5lcnMoKTtcbiAgICBiYW5uZXJzLnJ1bigpO1xufSk7Il19
